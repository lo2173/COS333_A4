<!DOCTYPE html>
<html>
    <head>
        <title>Registrar's Office</title>
        <meta name="viewport",
        content = "width=device-width, inital-scale=1">
        <link rel="stylesheet"
        href = "https://cdn.jsdeliver.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
        <style>
            tr:nth-child(even){background-color:#f2f2f2;}
        </style>
    </head>
    <body>
        <h1>Registrar's Office</h1>
        <h2>Class Search</h2>
        {% include 'searchform.html' %}
        <div id="results_div"></div>
        {%include 'footer.html'%}
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js">
        </script>

        <script>
            'use strict';

            function handleResponse(response)
            {
                $('#results_div').html(response);
            }

            let request = null;

            function getResults()
            {
                let dept_req = 'dept='+ encodeURIComponent($('#dept_input').val());
                let area_req = 'area='+ encodeURIComponent($('#area_input').val());
                let num_req = 'num='+ encodeURIComponent($('#num_input').val());
                let title_req = 'title='+ encodeURIComponent($('#title_input').val());

                let url = '/searchresults?'+dept_req+area_req+num_req+title_req

                if(request != null)
                    request.abort();
                request = $.ajax(
                    {
                    type: 'GET',
                    url: url,
                    success: handleResponse
                    }
                );
            }
            function setup(){
                $('#dept_input').on('input',getResults);
                $('#area_input').on('input',getResults);
                $('#num_input').on('input',getResults);
                $('#title_input').on('input',getResults);
            }
            $('document').ready(setup);
        </script>
    </body>

</html>
